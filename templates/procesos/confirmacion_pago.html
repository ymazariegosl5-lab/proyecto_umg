{% extends "base.html" %}
{% block title %}Pago Registrado{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <!-- Mensaje de éxito -->
            <div class="alert alert-success alert-dismissible fade show" role="alert">
                <h4 class="alert-heading">
                    <i class="bi bi-check-circle-fill"></i> ¡Pago Registrado Exitosamente!
                </h4>
                <hr>
                <p class="mb-0">El pago ha sido procesado correctamente. Puede imprimir el recibo ahora o regresar a la lista de pagos.</p>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Información del Pago -->
            <div class="card shadow mb-4">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0"><i class="bi bi-receipt"></i> Detalles del Pago</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong><i class="bi bi-person"></i> Cliente:</strong><br>
                            <span class="fs-5">{{ pago.nombre_cliente }}</span>
                        </div>
                        <div class="col-md-6">
                            <strong><i class="bi bi-hash"></i> No. Contador:</strong><br>
                            <code class="fs-5">{{ pago.no_contador }}</code>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong><i class="bi bi-calendar"></i> Fecha de Lectura:</strong><br>
                            {{ pago.fecha_lectura }}
                        </div>
                        <div class="col-md-6">
                            <strong><i class="bi bi-droplet"></i> Consumo:</strong><br>
                            {{ "%.2f"|format(pago.consumo) }} m³
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Lectura Anterior:</strong> {{ "%.2f"|format(pago.lectura_anterior) }} m³
                        </div>
                        <div class="col-md-6">
                            <strong>Lectura Actual:</strong> {{ "%.2f"|format(pago.lectura_actual) }} m³
                        </div>
                    </div>

                    <hr>

                    <div class="row">
                        <div class="col-12 text-center">
                            <h3 class="text-success">
                                <i class="bi bi-currency-dollar"></i> 
                                Monto Pagado: <strong>Q{{ "%.2f"|format(pago.monto) }}</strong>
                            </h3>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Botones de Acción -->
            <div class="card shadow">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <a href="{{ url_for('imprimir_recibo', id_lectura=pago.id_lectura) }}" 
                               class="btn btn-primary btn-lg w-100"
                               target="_blank">
                                <i class="bi bi-printer-fill"></i> Imprimir Recibo
                            </a>
                        </div>
                        <div class="col-md-6">
                            <a href="{{ url_for('ver_facturas_pendientes') }}" 
                               class="btn btn-success btn-lg w-100">
                                <i class="bi bi-arrow-left"></i> Volver a Pagos
                            </a>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <a href="{{ url_for('dashboard') }}" 
                               class="btn btn-outline-secondary w-100">
                                <i class="bi bi-house"></i> Ir al Dashboard
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Información adicional -->
            <div class="alert alert-info mt-3">
                <i class="bi bi-info-circle"></i> 
                <strong>Nota:</strong> El recibo se generará en formato PDF con dos copias: 
                una para el usuario y otra para la cooperativa.
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Auto-cerrar la alerta después de 5 segundos
setTimeout(function() {
    const alert = document.querySelector('.alert-success');
    if (alert) {
        const bsAlert = new bootstrap.Alert(alert);
        bsAlert.close();
    }
}, 5000);
</script>
{% endblock %}